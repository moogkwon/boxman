<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="dept">

	<!-- 부서등록 -->
	<insert id="insertDept" parameterType="map">
		INSERT INTO DEPARTMENT VALUES(seq_department.nextval,#{deptName}, default)
	</insert>
	
	<!-- 부서리스트출력 -->
	<select id="selectDeptList" resultType="map">
		SELECT D.DEPTNO, D.DEPTNAME, D.DEPTSTATUS, COUNT(A.EMPNO) AS COUNT FROM DEPARTMENT D
		LEFT JOIN EMPLOYEE A ON (D.DEPTNO=A.DEPTNO) GROUP BY D.DEPTNO, D.DEPTNAME, D.DEPTSTATUS
	</select>
	
	<!-- 부서 수정 -->
	<update id="updateDeptStatus" parameterType="_int">
		UPDATE DEPARTMENT SET 
		<if test="deptName != null">
			DEPTNAME = #{deptName}
		</if>
		<if test="deptStatus != null">
			,deptStatus = #{deptStatus}
		</if>
		WHERE DEPTNO=#{deptNo}
	</update>
	
	<!-- 부서상세 -->
	<select id="selectDeptOne" parameterType="_int" resultType="map">
		SELECT * FROM DEPARTMENT WHERE DEPTNO=#{deptNo}
	</select>

</mapper>
